# コンストラクタ

C++ でコンストラクタを使用する方法について説明します。

2つの整数値を受け取るコンストラクタを宣言するには次のようにします。

```cpp
class TwoArguments {
 public:
    TwoArguments(int a, int b);
};
```

クラス名と同じ名前で戻り値がない関数がコンストラクタになります。

このコンストラクタを使ってオブジェクトを作成するには次のようにします。

```cpp
TwoArguments t(1, 2);
```

コンストラクタの定義をクラス宣言の中に書く場合は次のようにします。

```cpp
class TwoArguments {
 public:
    TwoArguments(int a, int b) {
        std::cout << "a=" << a << std::endl;
        std::cout << "b=" << b << std::endl;
    }
};
```

コンストラクタの定義をクラス宣言の外に書く場合は次のようにします。

```cpp
class TwoArguments {
 public:
    TwoArguments(int a, int b);
};

TwoArguments::TwoArguments(int a, int b) {
    std::cout << "a=" << a << std::endl;
    std::cout << "b=" << b << std::endl;
}
```

## デフォルトコンストラクタ

値を1つも受け取らないコンストラクタをデフォルトコンストラクタといいます。

```cpp
class Default {
 public:
    Default();
};
```

デフォルトコンストラクタを使ってオブジェクトを作成するには次のようにします。

```cpp
Default d;
```

### コンパイラによる暗黙的な定義

デフォルトコンストラクタを明示的に定義しない場合、
そのクラスに明示的に定義されたコンストラクタが他にあるかによってコンパイラの挙動が変わります。

* コンストラクタを何も定義していない場合
    * コンパイラが暗黙的にデフォルトコンストラクタを定義します
* デフォルトコンストラクタ以外のコンストラクタが定義されている場合
    * コンパイラはデフォルトコンストラクタを定義しません

この挙動により、
コンストラクタを何も定義していないクラスのオブジェクトを作成している場合に、
デフォルトコンストラクタ以外のコンストラクタを追加するとコンパイルエラーになります。

```cpp
class Sample {
};

Sample sample;
```

このクラスに2つの整数値を受け取るコンストラクタを追加すると
デフォルトコンストラクタが未定義となるためコンパイルエラーになります。

```cpp
class Sample {
 public:
    Sample(int a, int b);  // コンストラクタを追加
};
```

## コピーコンストラクタ

そのクラスの参照だけを受け取るコンストラクタをコピーコンストラクタといいます。

```cpp
class Copyable {
 public:
    Copyable();  // デフォルトコンストラクタ
    Copyable(const Copyable& c);  // コピーコンストラクタ
};
```

コピーコンストラクタを使ってオブジェクトを作成するには次のようにします。

```cpp
Copyable c1;  // デフォルトコンストラクタでオブジェクト作成
Copyable c2(c1);  // コピーコンストラクタでオブジェクト作成
```

`const` ではない参照であってもコピーコンストラクタになりますが、
コピー元を変更せずにコピーを行うために `const` の参照にすることが多いです。

コピーコンストラクタを定義していないクラスでは、
コンパイラによって暗黙的にコピーコンストラクタが定義されます。

## ムーブコンストラクタ

そのクラスの右辺値参照だけを受け取るコンストラクタをムーブコンストラクタといいます。

```cpp
class Movable {
 public:
    Movable(Movable&& m);
};
```

ムーブコンストラクタを使ってオブジェクトを作成するには次のようにします。

```cpp
Movable m1;  // デフォルトコンストラクタでオブジェクト作成
Movable m2(std::move(m1));  // ムーブコンストラクタでオブジェクト作成
```
