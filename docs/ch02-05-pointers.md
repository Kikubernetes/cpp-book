# ポインタ

ポインタというのは他の変数を参照する仕組みの1つです。
Windows のショートカットや Linux のシンボリックリンクと同じような機能です。

```cpp
int x = 5;
int* p = &x;
```

`int*` と書くと `int` 型の変数を指すポインタ型となります。
`&x` というのは `x` を指すポインタを得るための演算です。

## nullptr

どの変数も参照していないポインタのことをヌルポインタと呼びます。C++ではヌルポインタを表すキーワードとして `nullptr` が用意されています。

```cpp
int* p = nullptr;
```

## デリファレンス（逆参照）

ポインタが指す変数の値を参照するには次のように書きます。

```cpp
int x = 5;
int* p = &x;
int y = *p;
```

変数からポインタを得るときには `&` を付け、ポインタから値を得るには `*` を付けます。

## constポインタ

ポインタ型に `const` を付ける場合、 `const` の付ける位置によって意味合いが変わります。

`*` の前に `const` を付けると、ポインタが指し示す値を書き換えることができなくなります。

```cpp
int x = 123;
const int* p = &x;
*p = 456; // エラー
```

`*` の後に `const` を付けると、ポインタ自身を書き換えることができなくなります。

```cpp
int x = 123;
int* const p = &x;
p = nullptr; // エラー
```

併用することも可能です。

```cpp
const int* const p = &x;
```

## 参照

ポインタに似た仕組みとして参照があります。

```cpp
int x = 100;
int* p = &x; // pはポインタ型
int& r = x; // rは参照型

*p = 200;
r = 200;
```

`int&` と書くと `int` の参照型となります。

ポインタが指し示す値を扱うには `*` を付けてデリファレンスする必要がありますが、
参照では何も付与する必要がないため、見た目上では値型のように使うことが出来ます。

## 関数ポインタ

関数を指し示すポインタを作成する場合は次のようにします。

```cpp
// 戻り値の型 (*変数名)(引数の型);
int (*f1)(double);    // double を引数として int を返す関数のポインタ f1
int (*f2)(int, int);  // 2つの int を引数として int を返す関数のポインタ f2
```

関数ポインタには、戻り値の型と引数の型・数・順番が一致している関数のアドレスが代入可能です。

```cpp
#include <iostream>

int Add(int x, int y) {
    return x + y;
}

int main() {
    int (*fp)(int, int) = Add;  // 関数 Add のアドレスを保持する関数ポインタ fp
    int result = fp(3, 5);      // 関数ポインタ fp を介して関数 Add が実行される
    std::cout << result << std::endl;  // 8

    return 0;
}
```